# HTML Reports

Truthound의 Data Docs 모듈은 데이터 프로파일 결과를 self-contained HTML 리포트로 변환합니다.

## Quick Start

```python
from truthound.datadocs import generate_html_report, HTMLReportBuilder

# 간단한 사용법
html = generate_html_report(
    profile=profile_dict,
    title="Data Quality Report",
    theme="professional",
    output_path="report.html",
)

# 파일에서 생성
from truthound.datadocs import generate_report_from_file

html = generate_report_from_file(
    profile_path="profile.json",
    output_path="report.html",
    title="My Report",
    theme="dark",
)
```

## HTMLReportBuilder

세밀한 제어가 필요할 때 `HTMLReportBuilder`를 직접 사용합니다.

### 기본 사용법

```python
from truthound.datadocs import HTMLReportBuilder, ReportTheme

builder = HTMLReportBuilder(theme=ReportTheme.PROFESSIONAL)
html = builder.build(
    profile=profile_dict,
    title="My Data Report",
    subtitle="Q4 2025 Analysis",
    description="Customer dataset quality analysis",
)
builder.save(html, "report.html")
```

### ReportConfig로 상세 설정

```python
from truthound.datadocs import (
    HTMLReportBuilder,
    ReportConfig,
    ReportTheme,
    SectionType,
)

config = ReportConfig(
    # 테마
    theme=ReportTheme.DARK,

    # 포함할 섹션 (순서대로)
    sections=[
        SectionType.OVERVIEW,
        SectionType.QUALITY,
        SectionType.COLUMNS,
        SectionType.PATTERNS,
        SectionType.DISTRIBUTION,
        SectionType.CORRELATIONS,
        SectionType.RECOMMENDATIONS,
        SectionType.ALERTS,
    ],

    # 레이아웃 옵션
    include_toc=True,
    include_header=True,
    include_footer=True,
    include_timestamp=True,
    include_download_button=True,
    embed_resources=True,
    minify_html=False,

    # 커스텀 콘텐츠
    custom_css="",
    custom_js="",
    logo_url=None,
    logo_base64=None,
    footer_text="Generated by Truthound",

    # 로컬라이제이션
    language="en",
    date_format="%Y-%m-%d %H:%M:%S",
    number_format=",.2f",
)

builder = HTMLReportBuilder(config=config)
html = builder.build(profile_dict)
```

## ProfileDataConverter

`ProfileDataConverter`는 TableProfile 데이터를 리포트용 구조로 변환합니다.

```python
from truthound.datadocs.builder import ProfileDataConverter

converter = ProfileDataConverter(profile_dict)

# 개요 메트릭 추출
metrics = converter.get_overview_metrics()
# {
#     "row_count": 10000,
#     "column_count": 15,
#     "memory_bytes": 1234567,
#     "duplicate_rows": 123,
#     "null_cells": 456,
#     "quality_score": 85.5,
# }

# 컬럼 데이터
columns = converter.get_column_data()

# 차트 스펙 생성
type_chart = converter.get_type_distribution()  # ChartSpec
null_chart = converter.get_null_distribution()  # ChartSpec
unique_chart = converter.get_uniqueness_distribution()  # ChartSpec

# 패턴 추출
patterns = converter.get_patterns()

# 상관관계 추출
correlations = converter.get_correlations()  # list[tuple[str, str, float]]

# 경고 생성
alerts = converter.get_alerts()  # list[AlertSpec]

# 추천 사항 생성
recommendations = converter.get_recommendations()  # list[str]
```

## Convenience Functions

### generate_html_report

```python
from truthound.datadocs import generate_html_report

html = generate_html_report(
    profile=profile_dict,        # TableProfile dict 또는 객체
    title="Data Quality Report", # 리포트 제목
    subtitle="",                 # 부제목
    theme="professional",        # 테마 이름 또는 ReportTheme
    output_path="report.html",   # 저장 경로 (선택적)
)
```

### generate_report_from_file

```python
from truthound.datadocs import generate_report_from_file

html = generate_report_from_file(
    profile_path="profile.json",  # 프로파일 JSON 파일 경로
    output_path="report.html",    # 출력 경로 (기본값: <input>.html)
    title="My Report",
    theme="dark",
)
```

### export_report

```python
from truthound.datadocs import export_report

# HTML 내보내기
export_report(profile_dict, "report.html", format="html")

# PDF 내보내기 (WeasyPrint 필요)
export_report(profile_dict, "report.pdf", format="pdf")
```

## 전체 Workflow 예시

```python
import truthound as th
from truthound.datadocs import generate_html_report

# 1. 데이터 로드
df = th.load("data.csv")

# 2. 프로파일 생성
from truthound.profiler import DataProfiler
profiler = DataProfiler()
profile = profiler.profile(df)

# 3. HTML 리포트 생성
html = generate_html_report(
    profile=profile.to_dict(),
    title="Customer Data Quality Report",
    subtitle="Q4 2025 Analysis",
    theme="professional",
    output_path="customer_report.html",
)

print(f"Report generated: {len(html):,} bytes")
```

## CLI 사용법

```bash
# 기본 사용
truthound docs generate profile.json -o report.html

# 커스텀 제목과 다크 테마
truthound docs generate profile.json -o report.html \
    --title "Q4 Data Quality Report" \
    --subtitle "Customer Dataset" \
    --theme dark

# PDF 내보내기
truthound docs generate profile.json -o report.pdf --format pdf
```

## 커스터마이징

### Custom CSS

```python
config = ReportConfig(
    custom_css="""
    .report-title {
        color: #ff6b6b;
    }
    .metric-card {
        border: 2px solid #4ecdc4;
    }
    """,
)
```

### Custom JavaScript

```python
config = ReportConfig(
    custom_js="""
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Report loaded!');
    });
    """,
)
```

### Logo 추가

```python
# URL로 로고 추가
config = ReportConfig(logo_url="https://example.com/logo.png")

# Base64로 로고 추가 (오프라인 지원)
import base64
with open("logo.png", "rb") as f:
    logo_b64 = base64.b64encode(f.read()).decode()

config = ReportConfig(logo_base64=f"data:image/png;base64,{logo_b64}")
```

## API Reference

### ReportConfig

```python
@dataclass
class ReportConfig:
    theme: ReportTheme = ReportTheme.PROFESSIONAL
    custom_theme: ThemeConfig | None = None
    chart_library: ChartLibrary = ChartLibrary.APEXCHARTS
    sections: list[SectionType] = [
        SectionType.OVERVIEW,
        SectionType.QUALITY,
        SectionType.COLUMNS,
        SectionType.PATTERNS,
        SectionType.DISTRIBUTION,
        SectionType.CORRELATIONS,
        SectionType.RECOMMENDATIONS,
        SectionType.ALERTS,
    ]
    include_toc: bool = True
    include_header: bool = True
    include_footer: bool = True
    include_timestamp: bool = True
    include_download_button: bool = True
    embed_resources: bool = True
    minify_html: bool = False
    custom_css: str = ""
    custom_js: str = ""
    logo_url: str | None = None
    logo_base64: str | None = None
    footer_text: str = "Generated by Truthound"
    language: str = "en"
    date_format: str = "%Y-%m-%d %H:%M:%S"
    number_format: str = ",.2f"
```

### ReportMetadata

```python
@dataclass
class ReportMetadata:
    title: str
    subtitle: str = ""
    description: str = ""
    data_source: str = ""
    created_at: datetime = field(default_factory=datetime.now)
    author: str = ""
    version: str = ""
```

## See Also

- [Themes](themes.md) - 테마 커스터마이징
- [Charts](charts.md) - 차트 렌더링
- [Sections](sections.md) - 섹션 구성
- [PDF Export](pdf-export.md) - PDF 내보내기
